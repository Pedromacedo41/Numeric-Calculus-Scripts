% Dados da Muniçao
IX = 0.023;
dgir = 0.10485;
M = 14.9698;
S = pi*0.10485*0.10485/4;

Cdtab = [0,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,1000;
0.13,0.13,0.12,0.117,0.115,0.115,0.118,0.125,0.145,0.185,0.26,0.337,0.385,0.415,0.415,0.405,0.39,0.375,0.357,0.34,0.323,0.305,0.27,0,0];
	
Cnatab = [0,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,1000;
1.45,1.45,1.5,1.53,1.56,1.59,1.63,1.65,1.65,1.7,1.8,1.9,2,2.15,2.4,2.5,2.55,2.6,2.7,2.75,0,0];

Cnpatab = [0,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,2.5,3,1000,
-0.8,-0.8,-0.84,-0.87,-0.89,-1.01,-1.13,-1.08,-1.03,-0.99,-0.94,-0.89,-0.8,-0.8,0,0];

Clptab = [0,0.75,0.8,0.85,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1000;
-0.028,-0.028,-0.0279,-0.0278,-0.0274,-0.0272,-0.0268,-0.0264,-0.026,-0.0256,-0.0248,-0.0246,-0.0245,-0.0245];

Cmatab = [0,0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,1000;
3.45,3.45,3.549,3.6,3.7,3.75,3.85,3.97,4.1,4.3,4.6,4.7,4.4,4.1,3.98,3.93,3.85,3.78,3.67,3.6,3.525,3.45,3.325,3.2,3.2];

% Dados Meteorologicos
Wx = 0;
Wy = 0;
Wz = 0;
G = 9.81;
TempFahr = 59;
OM = 0; %0.00007292;

% Dados do Tiro
V0 = 464.8;
P0 = 1545;
L = -45*pi/180;
AZ = -90*pi/180;
FI = input("TRAJETOGRAFO PARA 105mm M1\n\nInsira o angulo de elevacao:");
TETA = input("Insira o angulo de deriva: ");
X0 = Y0 = Z0 = 0;

% Incremento Desejado de Tempo
H = 0.01;

% Definiçao das condicoes iniciais
Vx = V0*cos(RAD(FI))*cos(RAD(TETA));
Vy = V0*sin(RAD(FI))*cos(RAD(TETA));
Vz = V0*sin(RAD(TETA));
TT = 0;
FLECHA = 0;
XX = X0;
YY = Y0;
ZZ = Z0;
UU = Vx-Wx;
VV = Vy-Wy;
WW = Vz-Wz;
RR = 0;
PP = P0;