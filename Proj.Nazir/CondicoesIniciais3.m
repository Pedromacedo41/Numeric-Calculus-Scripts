% Dados da Muniçao
M = 14.970;
S = pi*0.10485*0.10485/4;
Ix = 0.023303;
Iy = 0.22563;
DGIR = 0.10485;

Cdtab =[0,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,1000;
0.13,0.13,0.12,0.117,0.115,0.115,0.118,0.125,0.145,0.185,0.26,0.337,0.385,0.415,0.415,0.405,0.39,0.375,0.357,0.34,0.323,0.305,0.27,0,0];

Cnatab = [0,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,1000;
1.45,1.45,1.5,1.53,1.56,1.59,1.63,1.65,1.65,1.7,1.8,1.9,2,2.15,2.4,2.5,2.55,2.6,2.7,2.75,0,0];

Cnpatab = [0,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,2.5,3,1000;
-0.8,-0.8,-0.84,-0.87,-0.89,-1.01,-1.13,-1.08,-1.03,-0.99,-0.94,-0.89,-0.8,-0.8,0,0];

Clptab = [0,0.75,0.8,0.85,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1000;
-0.028,-0.028,-0.0279,-0.0278,-0.0274,-0.0272,-0.0268,-0.0264,-0.026,-0.0256,-0.0248,-0.0246,-0.0245,-0.0245];

Cmatab = [0,0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,1000;
3.45,3.45,3.549,3.6,3.7,3.75,3.85,3.97,4.1,4.3,4.6,4.7,4.4,4.1,3.98,3.93,3.85,3.78,3.67,3.6,3.525,3.45,3.325,3.2,3.2];
	
Cmqtab = [0,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1000;
-7.3,-7.3,-8,-8.4,-8.7,-9.1,-9.5,-10.2,-12,-13,-14,-15,-17,-17];

CnpAT1 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
-0.0175,-0.0175,-0.0175,-0.0175,-0.0175,-0.0175,-0.0159,-0.0150,-0.0141,-0.0133,-0.0085,-0.0042,0.0024,0.0050,0.0057,0.0061,0.0077,0.0077,0.0078,0.0078,0.0079,0.0080,0.0080,0.0084,0.0084,0.0084,0.0084,0.0084,0.0084,0.0084];
	
CnpAT2 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
-0.0248,-0.0248,-0.0248,-0.0248,-0.0248,-0.0248,-0.0215,-0.0197,-0.0180,-0.0163,-0.0084,-0.0013,0.0086,0.0124,0.0131,0.0135,0.0158,0.0158,0.0158,0.0160,0.0161,0.0161,0.0161,0.0133,0.0133,0.0133,0.0133,0.0133,0.0133,0.0133];
	
CnpAT3 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
-0.0168,-0.0168,-0.0168,-0.0168,-0.0168,-0.0168,-0.0116,-0.0089,-0.0063,-0.0037,0.0043,0.0123,0.0205,0.0230,0.0228,0.0229,0.0243,0.0243,0.0243,0.0244,0.0245,0.0246,0.0246,0.0124,0.0124,0.0124,0.0124,0.0124,0.0124,0.0124];

CnpAT4 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;-0.0061,-0.0061,-0.0061,-0.0061,-0.0061,-0.0061,0.0009,0.0044,0.0079,0.0114,0.0184,0.0273,0.0328,0.0334,0.0326,0.0323,0.0327,0.0327,0.0327,0.0328,0.0329,0.0329,0.0329,0.0082,0.0082,0.0082,0.0082,0.0082,0.0082,0.0082];

CnpAT5 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
0.0128,0.0128,0.0128,0.0128,0.0128,0.0128,0.0215,0.0258,0.0302,0.0346,0.0389,0.0477,0.0478,0.0452,0.0435,0.0427,0.0412,0.0413,0.0413,0.0413,0.0413,0.0413,0.0413,-0.0003,-0.0003,-0.0003,-0.0003,-0.0003,-0.0003,-0.0003];

CnpAT7v5 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
0.0605,0.0605,0.0605,0.0638,0.0654,0.0670,0.0806,0.0874,0.0942,0.1079,0.1216,0.1080,0.0899,0.0811,0.0727,0.0712,0.0682,0.0682,0.0682,0.0682,0.0682,0.0682,0.0682,-0.0002,-0.0002,-0.0002,-0.0002,-0.0002,-0.0002,-0.0002];
	
CnpAT10 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
0.1082,0.1082,0.1082,0.1147,0.1180,0.1212,0.1397,0.1490,0.1582,0.1813,0.2044,0.1682,0.1320,0.1170,0.1019,0.0997,0.0952,0.0952,0.0952,0.0952,0.0952,0.0952,0.0952,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000];
	
CnpAT15 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
0.1532,0.1532,0.1532,0.1624,0.1671,0.1717,0.1979,0.2110,0.2241,0.2568,0.2895,0.2382,0.1870,0.1656,0.1443,0.1412,0.1348,0.1348,0.1348,0.1348,0.1348,0.1348,0.1348,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000];
	
CnpAT20 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
0.1918,0.1918,0.1918,0.2034,0.2091,0.2149,0.2477,0.2641,0.2805,0.3214,0.3624,0.2982,0.2341,0.2074,0.1807,0.1767,0.1688,0.1688,0.1688,0.1688,0.1688,0.1688,0.1688,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000];
	
CnpAT30 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
0.2524,0.2524,0.2524,0.2676,0.2752,0.2827,0.3259,0.3475,0.3691,0.4229,0.4768,0.3924,0.3080,0.2728,0.2377,0.2325,0.2221,0.2221,0.2221,0.2221,0.2221,0.2221,0.2221,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000];
	
CnpAT60 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
0.3400,0.3400,0.3400,0.3605,0.3707,0.3809,0.4390,0.4681,0.4972,0.5697,0.6423,0.5286,0.4149,0.3676,0.3203,0.3132,0.2991,0.2991,0.2991,0.2991,0.2991,0.2991,0.2991,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000];
	
CnpAT90 = [0.01,0.4,0.6,0.7,0.75,0.8,0.85,0.875,0.9,0.925,0.95,0.975,1,1.025,1.05,1.1,1.2,1.35,1.5,1.75,2,2.25,2.5,3,3.5,4,4.5,5,6,8;
0.2804,0.2804,0.2804,0.2973,0.3057,0.3142,0.3621,0.3861,0.4101,0.4699,0.5297,0.4360,0.3422,0.3032,0.2642,0.2584,0.2467,0.2467,0.2467,0.2467,0.2467,0.2467,0.2467,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.0000];


% Dados Meteorologicos
	Wx0a2000 = 0; Wx2000a4000 = 0; Wx4000a6000 = 0; Wx6000a8000 = 0;
	Wy0a2000 = 0; Wy2000a4000 = 0; Wy4000a6000 = 0; Wy6000a8000 = 0;
	Wz0a2000 = 0; Wz2000a4000 = 0; Wz4000a6000 = 0; Wz6000a8000 = 0;
	G = 9.81;
	TempFahr = 59;

% Dados do Tiro
V0 = 464.8;
P0 = 1545;
FI = input("TRAJETOGRAFO PARA 105mm M1\n\nInsira o angulo de elevacao:");
TETA = input("Insira o angulo de deriva: ");
X0 = Y0 = Z0 = 0;
Alfa = 0;
Beta = 0;	

% Incremento Desejado de Tempo
H = 0.01;

% Definiçao das condicoes iniciais
	
Vx = V0*cos(RAD(FI))*cos(RAD(TETA));
Vy = V0*sin(RAD(FI))*cos(RAD(TETA));
Vz = V0*sin(RAD(TETA));
Q = pow(sin(RAD(TETA+Beta)),2)+pow(cos(RAD(TETA+Beta)),2)*pow(cos(RAD(FI+Alfa)),2);

X1 = cos(RAD(FI+Alfa))*cos(RAD(TETA+Beta));
X2 = sin(RAD(FI+Alfa))*cos(RAD(TETA+Beta));
X3 = sin(RAD(TETA+Beta));
Y1 = 1/sqrt(Q)*(-pow(cos(RAD(TETA+Beta)),2)*sin(RAD(FI+Alfa))*cos(RAD(FI+Alfa)));
Y2 = 1/sqrt(Q)*(pow(cos(RAD(TETA+Beta)),2)*sin(RAD(FI+Alfa))+pow(sin(RAD(TETA+Beta)),2));
Y3 = 1/sqrt(Q)*(-sin(RAD(TETA+Beta))*cos(RAD(TETA+Beta))*sin(RAD(FI+Alfa)));
Z1 = 1/sqrt(Q)*(-sin(RAD(TETA+Beta)));
Z2 = 0;
Z3 = 1/sqrt(Q)*cos(RAD(TETA+Beta))*cos(RAD(FI+Alfa));
H1 = Ix*P0/Iy*X1;
H2 = Ix*P0/Iy*X2;
H3 = Ix*P0/Iy*X3;
TT = 0;
XX = X0;
YY = Y0;
ZZ = Z0;
UU = Vx-Wx;
VV = Vy-Wy;
WW = Vz-Wz;